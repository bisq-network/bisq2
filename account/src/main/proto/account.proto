/*
 * This file is part of Bisq.
 *
 * Bisq is free software: you can redistribute it and/or modify it
 * under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or (at
 * your option) any later version.
 *
 * Bisq is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public
 * License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with Bisq. If not, see <http://www.gnu.org/licenses/>.
 */

syntax = "proto3";

package account;
option java_package = "bisq.account.protobuf";
option java_multiple_files = true;

import "common.proto";
import "security.proto";


// TimestampType
enum TimestampType {
  TIMESTAMPTYPE_UNSPECIFIED = 0;
  TIMESTAMPTYPE_BISQ1_IMPORTED = 1;
  TIMESTAMPTYPE_BISQ2_NEW = 2;
}
message AuthorizeAccountTimestampRequest {
  TimestampType timestampType = 1;
  AccountTimestamp accountTimestamp = 2;
  bytes saltedFingerprint = 3;
  bytes publicKey = 4;
  bytes signature = 5;
  KeyAlgorithm keyAlgorithm = 6;
}
message AuthorizedAccountTimestamp {
  AccountTimestamp accountTimestamp = 1;
  bool staticPublicKeysProvided = 2;
  uint32 version = 3;
}


// ProtocolType
enum TradeProtocolType {
  TRADEPROTOCOLTYPE_UNSPECIFIED = 0;
  TRADEPROTOCOLTYPE_BISQ_EASY = 1;
  TRADEPROTOCOLTYPE_MU_SIG = 2;
  TRADEPROTOCOLTYPE_SUBMARINE = 3;
  TRADEPROTOCOLTYPE_LIQUID_MU_SIG = 4;
  TRADEPROTOCOLTYPE_BISQ_LIGHTNING = 5;
  TRADEPROTOCOLTYPE_LIQUID_SWAP = 6;
  TRADEPROTOCOLTYPE_BSQ_SWAP = 7;
  TRADEPROTOCOLTYPE_LIGHTNING_ESCROW = 8;
  TRADEPROTOCOLTYPE_MONERO_SWAP = 9;
}
enum LoanProtocolType {
  LOANPROTOCOLTYPE_UNSPECIFIED = 0;
  LOANPROTOCOLTYPE_COLLATERALIZED = 1;
  LOANPROTOCOLTYPE_REPUTATION = 2;
}
message ProtocolType {
  oneof message {
    TradeProtocolType tradeProtocolType = 10;
    LoanProtocolType loanProtocolType = 11;
  }
}


// PaymentMethod
message PaymentMethod {
  string paymentRailName = 1;
  oneof message {
    FiatPaymentMethod fiatPaymentMethod = 10;
    BitcoinPaymentMethod bitcoinPaymentMethod = 11;
    CryptoPaymentMethod cryptoPaymentMethod = 12;
    StableCoinPaymentMethod stableCoinPaymentMethod = 13;
    CbdcPaymentMethod cbdcPaymentMethod = 14;
  }
}
message FiatPaymentMethod {
}
message BitcoinPaymentMethod {
}
message CryptoPaymentMethod {
  string code = 1;
}
message StableCoinPaymentMethod {
}
message CbdcPaymentMethod {
}
message FiatPaymentMethodSpec {
}
message BitcoinPaymentMethodSpec {
}
message CryptoPaymentMethodSpec {
}
message StableCoinPaymentMethodSpec {
}
message CbdcPaymentMethodSpec {
}
message PaymentMethodSpec {
  account.PaymentMethod paymentMethod = 1;
  optional string saltedMakerAccountId = 2;
  oneof message {
    BitcoinPaymentMethodSpec bitcoinPaymentMethodSpec = 10;
    FiatPaymentMethodSpec fiatPaymentMethodSpec = 11;
    CryptoPaymentMethodSpec cryptoPaymentMethodSpec = 12;
    StableCoinPaymentMethodSpec stableCoinPaymentMethodSpec = 13;
    CbdcPaymentMethodSpec cbdcPaymentMethodSpec = 14;
  }
}


// AccountPayload
message AccountPayload {
  string id = 1;
  bytes salt = 2;
  oneof message {
    UserDefinedFiatAccountPayload userDefinedFiatAccountPayload = 20;

    AdvancedCashAccountPayload advancedCashAccountPayload = 30;
    CashByMailAccountPayload cashByMailAccountPayload = 31;
    CountryBasedAccountPayload countryBasedAccountPayload = 32;
    MercadoPagoAccountPayload mercadoPagoAccountPayload = 33;
    MoneseAccountPayload moneseAccountPayload = 34;
    PayseraAccountPayload payseraAccountPayload = 35;
    PerfectMoneyAccountPayload perfectMoneyAccountPayload = 36;
    RevolutAccountPayload RevolutAccountPayload = 37;
    SatispayAccountPayload satispayAccountPayload = 38;
    UpholdAccountPayload upholdAccountPayload = 39;
    VerseAccountPayload verseAccountPayload = 40;

    CryptoAssetAccountPayload cryptoAssetAccountPayload = 100;
  }
}
message CountryBasedAccountPayload {
  string countryCode = 1;
  oneof message {
    AliPayAccountPayload aliPayAccountPayload = 20;
    AmazonGiftCardAccountPayload amazonGiftCardAccountPayload = 21;
    BankAccountPayload bankAccountPayload = 22;
    BizumAccountPayload bizumAccountPayload = 23;
    F2FAccountPayload f2fAccountPayload = 24;
    FasterPaymentsAccountPayload fasterPaymentsAccountPayload = 25;
    HalCashAccountPayload halCashAccountPayload = 26;
    ImpsAccountPayload impsAccountPayload = 27;
    InteracETransferAccountPayload interacETransferAccountPayload = 28;
    MoneyBeamAccountPayload moneyBeamAccountPayload = 29;
    MoneyGramAccountPayload moneyGramAccountPayload = 30;
    NeftAccountPayload neftAccountPayload = 31;
    PayIdAccountPayload payIdAccountPayload = 32;
    Pin4AccountPayload pin4AccountPayload = 33;
    PixAccountPayload pixAccountPayload = 34;
    PromptPayAccountPayload promptPayAccountPayload = 35;
    SbpAccountPayload sbpAccountPayload = 36;
    SepaAccountPayload sepaAccountPayload = 37;
    SepaInstantAccountPayload sepaInstantAccountPayload = 38;
    StrikeAccountPayload strikeAccountPayload = 39;
    SwishAccountPayload swishAccountPayload = 40;
    UpiAccountPayload upiAccountPayload = 41;
    USPostalMoneyOrderAccountPayload usPostalMoneyOrderAccountPayload = 42;
    WeChatPayAccountPayload weChatPayAccountPayload = 43;
    WiseAccountPayload wiseAccountPayload = 44;
    WiseUsdAccountPayload wiseUsdAccountPayload = 45;
    ZelleAccountPayload zelleAccountPayload = 46;
  }
}
message BankAccountPayload {
  string selectedCurrencyCode = 1;
  optional string holderName = 2;
  optional string holderId = 3;
  optional string bankName = 4;
  optional string bankId = 5;
  optional string branchId = 6;
  string accountNr = 7;
  optional BankAccountType bankAccountType = 8;
  optional string nationalAccountId = 9;
  oneof message {
    AchTransferAccountPayload achTransferAccountPayload = 20;
    NationalBankAccountPayload nationalBankAccountPayload = 21;
    CashDepositAccountPayload cashDepositAccountPayload = 22;
    SameBankAccountPayload sameBankAccountPayload = 23;
    DomesticWireTransferAccountPayload domesticWireTransferAccountPayload = 24;
    //SpecificBanksAccountPayload
  }
}
// Bisq Easy legacy
message UserDefinedFiatAccountPayload {
  string accountData = 2;
}

// Crypto AccountPayloads
message CryptoAssetAccountPayload {
  string currencyCode = 1;
  string address = 2;
  bool isInstant = 3;
  optional bool isAutoConf = 4;
  optional sint32 autoConfNumConfirmations = 5;
  optional sint64 autoConfMaxTradeAmount = 6;
  optional string autoConfExplorerUrls = 7;
  oneof message {
    MoneroAccountPayload moneroAccountPayload = 10;
    OtherCryptoAssetAccountPayload otherCryptoAssetAccountPayload = 11;
  }
}

message MoneroAccountPayload {
  bool useSubAddresses = 1;
  optional string mainAddress = 2;
  optional string privateViewKey = 3;
  optional string subAddress = 4;
  optional sint32 accountIndex = 5;
  optional sint32 initialSubAddressIndex = 6;
}
message OtherCryptoAssetAccountPayload {
}

// Fiat AccountPayloads
message AchTransferAccountPayload {
  string holderAddress = 1;
}
message AdvancedCashAccountPayload {
  repeated string selectedCurrencyCodes = 1;
  string accountNr = 2;
}
message AliPayAccountPayload {
  string accountNr = 1;
}
message AmazonGiftCardAccountPayload {
  string selectedCurrencyCode = 1;
  string emailOrMobileNr = 2;
}
message BizumAccountPayload {
  string mobileNr = 1;
}
message CashByMailAccountPayload {
  string selectedCurrencyCode = 1;
  string postalAddress = 2;
  string contact = 3;
  string extraInfo = 4;
}
message CashDepositAccountPayload {
  optional string requirements = 1;
}
message DomesticWireTransferAccountPayload {
  string holderAddress = 1;
}
message F2FAccountPayload {
  string selectedCurrencyCode = 1;
  string contact = 2;
  string city = 3;
  string extraInfo = 4;
}
message FasterPaymentsAccountPayload {
  string holderName = 1;
  string sortCode = 2;
  string accountNr = 3;
}
message HalCashAccountPayload {
  string mobileNr = 1;
}
message ImpsAccountPayload {
  string holderName = 1;
  string accountNr = 2;
  string ifsc = 3;
}
message InteracETransferAccountPayload {
  string holderName = 1;
  string email = 2;
  string question = 3;
  string answer = 4;
}
message MercadoPagoAccountPayload {
  string holderName = 1;
  string holderId = 2;
}
message MoneseAccountPayload {
  string selectedCurrencyCode = 1;
  string holderName = 2;
  string mobileNr = 3;
}
message MoneyBeamAccountPayload {
  string selectedCurrencyCode = 1;
  string holderName = 2;
  string emailOrMobileNr = 3;
}
message MoneyGramAccountPayload {
  repeated string selectedCurrencyCodes = 1;
  string holderName = 2;
  string email = 3;
  string state = 4;
}
message NationalBankAccountPayload {
  string selectedCurrencyCode = 1;
}
message NeftAccountPayload {
  string holderName = 1;
  string accountNr = 2;
  string ifsc = 3;
}
message PayIdAccountPayload {
  string holderName = 1;
  string payId = 2;
}
message PayseraAccountPayload {
  string selectedCurrencyCode = 1;
  string email = 2;
}
message PerfectMoneyAccountPayload {
  string accountNr = 1;
}
message Pin4AccountPayload {
  string mobileNr = 1;
}
message PixAccountPayload {
  string holderName = 1;
  string pixKey = 2;
}
message PromptPayAccountPayload {
  string promptPayId = 1;
}
message RevolutAccountPayload {
  string userName = 1;
  repeated string selectedCurrencyCodes = 2;
}
message SameBankAccountPayload {
}
message SatispayAccountPayload {
  string holderName = 1;
  string mobileNr = 2;
}
message SbpAccountPayload {
  string holderName = 1;
  string mobileNumber = 2;
  string bankName = 3;
}
message SepaAccountPayload {
  string holderName = 1;
  string iban = 2;
  string bic = 3;
  repeated string acceptedCountryCodes = 4;
}
message SepaInstantAccountPayload {
  string holderName = 1;
  string iban = 2;
  string bic = 3;
  repeated string acceptedCountryCodes = 4;
}
message StrikeAccountPayload {
  string holderName = 1;
}
message SwishAccountPayload {
  string holderName = 1;
  string mobileNr = 2;
}
message USPostalMoneyOrderAccountPayload {
  string holderName = 1;
  string postalAddress = 2;
}
message UpholdAccountPayload {
  repeated string selectedCurrencyCodes = 1;
  string holderName = 2;
  string accountId = 3;
}
message UpiAccountPayload {
  string virtualPaymentAddress = 1;
}
message VerseAccountPayload {
  string selectedCurrencyCode = 1;
  string holderName = 2;
}
message WeChatPayAccountPayload {
  string accountNr = 1;
}
message WiseAccountPayload {
  repeated string selectedCurrencyCodes = 1;
  string holderName = 2;
  string email = 3;
}
message WiseUsdAccountPayload {
  string holderName = 1;
  string email = 2;
  string beneficiaryAddress = 3;
}
message ZelleAccountPayload {
  string holderName = 1;
  string emailOrMobileNr = 2;
}


// Account
enum BankAccountType {
  BANKACCOUNTTYPE_UNSPECIFIED = 0;
  BANKACCOUNTTYPE_CHECKING = 1;
  BANKACCOUNTTYPE_SAVINGS = 2;
}
enum KeyAlgorithm{
  KEYALGORITHM_UNSPECIFIED = 0;
  KEYALGORITHM_DSA = 1;
  KEYALGORITHM_EC = 2;
}
enum AccountOrigin{
  ACCOUNTORIGIN_UNSPECIFIED = 0;
  ACCOUNTORIGIN_BISQ1_IMPORTED = 1;
  ACCOUNTORIGIN_BISQ2_NEW = 2;
}
message Account {
  sint64 creationDate = 1;
  string accountName = 2;
  AccountPayload accountPayload = 3;
  PaymentMethod paymentMethod = 4;
  string id = 5;
  security.KeyPair keyPair = 6;
  KeyAlgorithm keyAlgorithm = 7;
  AccountOrigin accountOrigin = 8;

  oneof message {
    UserDefinedFiatAccount userDefinedFiatAccount = 20;

    AdvancedCashAccount advancedCashAccount = 30;
    CashByMailAccount cashByMailAccount = 31;
    CountryBasedAccount countryBasedAccount = 32;
    MercadoPagoAccount mercadoPagoAccount = 33;
    MoneseAccount moneseAccount = 34;
    PayseraAccount payseraAccount = 35;
    PerfectMoneyAccount perfectMoneyAccount = 36;
    RevolutAccount revolutAccount = 37;
    SatispayAccount satispayAccount = 38;
    UpholdAccount upholdAccount = 39;
    VerseAccount verseAccount = 40;

    CryptoAssetAccount cryptoAssetAccount = 100;
  }
}
message CountryBasedAccount {
  oneof message {
    AliPayAccount aliPayAccount = 20;
    AmazonGiftCardAccount amazonGiftCardAccount = 21;
    BankAccount bankAccount = 22;
    BizumAccount bizumAccount = 23;
    F2FAccount f2fAccount = 24;
    FasterPaymentsAccount fasterPaymentsAccount = 25;
    HalCashAccount halCashAccount = 26;
    ImpsAccount impsAccount = 27;
    InteracETransferAccount interacETransferAccount = 28;
    MoneyBeamAccount moneyBeamAccount = 29;
    MoneyGramAccount moneyGramAccount = 30;
    NeftAccount neftAccount = 31;
    PayIdAccount payIdAccount = 32;
    Pin4Account pin4Account = 33;
    PixAccount pixAccount = 34;
    PromptPayAccount promptPayAccount = 35;
    SbpAccount sbpAccount = 36;
    SepaAccount sepaAccount = 37;
    SepaInstantAccount sepaInstantAccount = 38;
    StrikeAccount strikeAccount = 39;
    SwishAccount swishAccount = 40;
    UpiAccount upiAccount = 41;
    USPostalMoneyOrderAccount usPostalMoneyOrderAccount = 42;
    WeChatPayAccount weChatPayAccount = 43;
    WiseAccount wiseAccount = 44;
    WiseUsdAccount wiseUsdAccount = 45;
    ZelleAccount zelleAccount = 46;
  }
}
message BankAccount {
  oneof message {
    AchTransferAccount achTransferAccount = 1;
    NationalBankAccount nationalBankAccount = 2;
    CashDepositAccount cashDepositAccount = 3;
    SameBankAccount sameBankAccount = 4;
    DomesticWireTransferAccount domesticWireTransferAccount = 5;
  }
}

message CryptoAssetAccount {
  oneof message {
    MoneroAccount moneroAccount = 10;
    OtherCryptoAssetAccount otherCryptoAssetAccount = 11;
  }
}

// Crypto accounts
message MoneroAccount {
}
message OtherCryptoAssetAccount {
}

// Fiat accounts
message AchTransferAccount {
}
message AdvancedCashAccount {
}
message AliPayAccount {
}
message AmazonGiftCardAccount {
}

message BizumAccount {
}
message CashByMailAccount {
}
message CashDepositAccount {
}
message DomesticWireTransferAccount {
}
message F2FAccount {
}
message FasterPaymentsAccount {
}
message HalCashAccount {
}
message ImpsAccount {
}
message InteracETransferAccount {
}
message MercadoPagoAccount {
}
message MoneseAccount {
}
message MoneyBeamAccount {
}
message MoneyGramAccount {
}
message NationalBankAccount {
}
message NeftAccount {
}
message PayIdAccount {
}
message PayseraAccount {
}
message PerfectMoneyAccount {
}
message Pin4Account {
}
message PixAccount {
}
message PromptPayAccount {
}
message RevolutAccount {
}
message SameBankAccount {
}
message SatispayAccount {
}
message SbpAccount {
}
message SepaAccount {
}
message SepaInstantAccount {
}
message StrikeAccount {
}
message SwishAccount {
}
message USPostalMoneyOrderAccount {
}
message UpholdAccount {
}
message UpiAccount {
}
message UserDefinedFiatAccount {
}
message VerseAccount {
}
message WeChatPayAccount {
}
message WiseAccount {
}
message WiseUsdAccount {
}
message ZelleAccount {
}

message AccountStore {
  map<string, Account> accountByName = 1;
  optional Account selectedAccount = 2;
}
message AccountTimestamp {
  bytes hash = 1;
  uint64 date = 2;
}
